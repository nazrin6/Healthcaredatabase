CREATE DATABASE HEALTHCARE
CREATE TABLE PERSONS(
ID INT PRIMARY KEY,
NAME VARCHAR(50) NOT NULL,
SURNAME VARCHAR(50) NOT NULL,
GENDER VARCHAR(50) NOT NULL,
ADDRES VARCHAR(30) NOT NULL,
PHONENUMBER VARCHAR(30) NOT NULL,
DATEOFBIRTH DATE NOT NULL,
AGE INT NOT NULL)

INSERT INTO PERSONS
VALUES (500,'John','SMITH','Male','S134','6857100','1965-11-09',55)
INSERT INTO PERSONS
VALUES (501,'PAM','YANSON','Male','F345','1245600','1971-11-05',49)
INSERT INTO PERSONS
VALUES (502,'SARA','GRAHAM','Female','A234','3425700','1978-05-14',42)
INSERT INTO PERSONS
VALUES (503,'SAM','BENTHAM','Male','B264','4525700','1983-06-14',37)
INSERT INTO PERSONS
VALUES (504,'JANE','BENSON','Female','K354','3425890','1989-01-27',31)
INSERT INTO PERSONS
VALUES (505,'MIKE','HARLEY','Male','L289','9065400','1967-08-20',53)
INSERT INTO PERSONS
VALUES (506,'THOMAS','CHASON','Male','W278','895600','1956-02-18',64)
INSERT INTO PERSONS
VALUES (507,'Elizabeth','GRAHAM','Female','O178','1289465','1968-05-14',52)
INSERT INTO PERSONS
VALUES (508,'JESSICA','LOAREN','Female','8924','1067500','1980-05-31',40)
INSERT INTO PERSONS
VALUES (509,'JACOB','OTTO','Male','4567','2783940','1959-07-13',61)


SELECT * FROM PERSONS


CREATE TABLE DOCTORS (
ID INT NOT NULL,
DOCTOR_ID INT PRIMARY KEY ,
DOCT_TYPE VARCHAR(50) NOT NULL,
SALARY INT NOT NULL);
INSERT INTO DOCTORS
VALUES (500,200,'EPIDOMOLOG',10000)
INSERT INTO DOCTORS
VALUES (501,201,'EPIDOMOLOG',10000)
INSERT INTO DOCTORS
VALUES (502,202,'Pediatrician',35000)
INSERT INTO DOCTORS
VALUES (503,203,'Neurologist',357000)
INSERT INTO DOCTORS
VALUES (504,204,'Allergist',26000)
INSERT INTO DOCTORS
VALUES (505,205,'Oncologist',30000)
 
select *from ROOMS
SELECT MAX(AGE),GENDER FROM PERSONS 
GROUP BY GENDER
HAVING MAX(AGE)>50
ORDER BY MAX(AGE)
DESC

SELECT * FROM DISEASE
WHERE DISEASE_NAME LIKE 'c%'
ORDER BY DISEASE_NAME 
DESC


SELECT  *FROM BILL
select * from directed
ALTER TABLE DOCTORS
ADD CONSTRAINT FK_PERSON_DOCTOR_ID
FOREIGN KEY(ID)
REFERENCES PERSONS(ID)



CREATE TABLE PROCEDURES(
PROC_ID INT PRIMARY KEY,
COST INT NOT NULL,
PROC_TYPE VARCHAR(50) NOT NULL,
PROC_TIME TIME NOT NULL)

INSERT INTO PROCEDURES
VALUES(300,200,'ADMISSION','13:23:44')
INSERT INTO PROCEDURES
VALUES(301,150,'SYMTOP CONTROL','10:23:35')
INSERT INTO PROCEDURES
VALUES(302,320,'ANALYSIS','19:20:29')
INSERT INTO PROCEDURES
VALUES(303,129,'MRT','11:28:44')
INSERT INTO PROCEDURES
VALUES(304,456,'HEART CONTROL','12:33:32')

SELECT * FROM PROCEDURES


CREATE TABLE MEDICATIONS(
MED_ID INT PRIMARY KEY,
MED_FORM VARCHAR(50) NOT NULL,
BRAND_NAME VARCHAR(50) NOT NULL)

INSERT INTO MEDICATIONS
VALUES (400,'PIL','Abraxane')
INSERT INTO MEDICATIONS
VALUES (401,'CAPSUL','Blincyto')
INSERT INTO MEDICATIONS
VALUES (402,'SYRUP','Boostrix')
INSERT INTO MEDICATIONS
VALUES (403,'TABLET','Chemet Capsules')
INSERT INTO MEDICATIONS
VALUES (404,'HERBAL','Colcrys tablet')

SELECT *FROM MEDICATIONS

CREATE TABLE DIRECTED(
DOCTOR_ID INT NOT NULL,
PROC_ID INT NOT NULL)


INSERT INTO DIRECTED 
VALUES (200,300)
INSERT INTO DIRECTED 
VALUES (201,301)
INSERT INTO DIRECTED 
VALUES (202,302)
INSERT INTO DIRECTED 
VALUES (203,303)
INSERT INTO DIRECTED
VALUES (204,304)

SELECT * FROM DIRECTED

SELECT *FROM DIRECTED

ALTER TABLE DIRECTED
ADD CONSTRAINT FK_DOCTOR_ID
FOREIGN KEY(DOCTOR_ID)
REFERENCES DOCTORS(DOCTOR_ID)


ALTER TABLE DIRECTED
ADD CONSTRAINT FK_PROCDOCTOR_ID
FOREIGN KEY(PROC_ID)
REFERENCES PROCEDURES(PROC_ID)


CREATE TABLE DETERMINE(
 DOCTOR_ID INT NOT NULL,
 MED_ID INT NOT NULL)

  ALTER TABLE DETERMINE
ADD CONSTRAINT FK_DOCTORDETERMINE_ID
FOREIGN KEY(DOCTOR_ID)
REFERENCES DOCTORS(DOCTOR_ID)



ALTER TABLE DETERMINE
ADD CONSTRAINT FK_MEDDOCTOR_ID
FOREIGN KEY(MED_ID)
REFERENCES MEDICATIONS(MED_ID)

INSERT INTO DETERMINE
VALUES (200,400)
INSERT INTO DETERMINE
VALUES (201,401)
INSERT INTO DETERMINE
VALUES (202,402)
INSERT INTO DETERMINE
VALUES (203,403)
INSERT INTO DETERMINE
VALUES (204,404)






CREATE TABLE PATIENTS(
ID INT ,
PATIENT_ID INT PRIMARY KEY,
ROOMNUMBER INT NOT NULL
)

INSERT INTO PATIENTS
VALUES(505,100,1)
INSERT INTO PATIENTS
VALUES(506,101,2)
INSERT INTO PATIENTS
VALUES(507,102,3)
INSERT INTO PATIENTS
VALUES(508,103,4)
INSERT INTO PATIENTS
VALUES(509,104,5)

SELECT * FROM PATIENTS
ALTER TABLE PATIENTS
ADD CONSTRAINT FK_PERSONPATIENT_ID
FOREIGN KEY(ID)
REFERENCES PERSONS(ID)


CREATE TABLE CHOOOSE(
PATIENT_ID INT NOT NULL,
PROC_ID INT NOT NULL)

INSERT INTO CHOOOSE
VALUES (100,300)
INSERT INTO CHOOOSE
VALUES (101,301)
INSERT INTO CHOOOSE
VALUES (102,302)
INSERT INTO CHOOOSE
VALUES (103,303)
INSERT INTO CHOOOSE
VALUES (104,304)

SELECT *FROM CHOOOSE



ALTER TABLE CHOOOSE
ADD CONSTRAINT FK_PATIENTCHOOSE_ID
FOREIGN KEY(PATIENT_ID)
REFERENCES PATIENTS(PATIENT_ID)

ALTER TABLE CHOOOSE
ADD CONSTRAINT FK_PATIENTPROC_ID
FOREIGN KEY(PROC_ID)
REFERENCES PROCEDURES(PROC_ID)

CREATE TABLE TAKES(
PATIENT_ID INT NOT NULL,
MED_ID INT NOT NULL)


ALTER TABLE TAKES
ADD CONSTRAINT FK_PATIENTMED_ID
FOREIGN KEY(MED_ID)
REFERENCES MEDICATIONS(MED_ID)


ALTER TABLE TAKES
ADD CONSTRAINT FK_PATIENT_ID
FOREIGN KEY(PATIENT_ID)
REFERENCES PATIENTS(PATIENT_ID)

INSERT INTO TAKES
VALUES (100,400)
INSERT INTO TAKES
VALUES (101,401)
INSERT INTO TAKES
VALUES (102,402)
INSERT INTO TAKES
VALUES (103,403)
INSERT INTO TAKES
VALUES (104,404)

SELECT *FROM TAKES


CREATE TABLE WRITTEN (
PROC_ID INT NOT NULL,
MED_ID INT NOT NULL)

INSERT INTO WRITTEN
VALUES (300,400)
INSERT INTO WRITTEN
VALUES (301,401)
INSERT INTO WRITTEN
VALUES (302,402)
INSERT INTO WRITTEN
VALUES (303,403)
INSERT INTO WRITTEN
VALUES (304,404)

SELECT * FROM WRITTEN


ALTER TABLE WRITTEN
ADD CONSTRAINT FK_PROCMED_ID
FOREIGN KEY(PROC_ID)
REFERENCES PROCEDURES(PROC_ID)



ALTER TABLE WRITTEN
ADD CONSTRAINT FK_PROCMEDD_ID
FOREIGN KEY(MED_ID)
REFERENCES MEDICATIONS(MED_ID)


CREATE TABLE ROOMS(
ROOMNUMBER INT PRIMARY KEY,
SIZE INT NOT NULL,
REMAININGTIME TIME NOT NULL)


INSERT INTO ROOMS
VALUES (01,20,'')
INSERT INTO ROOMS
VALUES (02,17,'12:14:35')
INSERT INTO ROOMS
VALUES (03,18,'15:45:21')
INSERT INTO ROOMS
VALUES (04,16,'13:23:44')
INSERT INTO ROOMS
VALUES (05,12,'11:12:01')

SELECT *FROM ROOMS

ALTER TABLE PATIENTS
ADD CONSTRAINT FK_PATIENTROOM_ID
FOREIGN KEY(ROOMNUMBER)
REFERENCES ROOMS(ROOMNUMBER)

CREATE TABLE DISEASE(
PATIENT_ID INT NOT NULL,
DISEASE_NAME VARCHAR(30) NOT NULL)

INSERT INTO DISEASE
VALUES (100,'CANCER')
INSERT INTO DISEASE
VALUES (101,'CORONA')
INSERT INTO DISEASE
VALUES (102,'ASTHMA')
INSERT INTO DISEASE
VALUES (103,'DIABETES')
INSERT INTO DISEASE
VALUES (104,'LUPUS')

SELECT *FROM DISEASE

ALTER TABLE DISEASE
ADD CONSTRAINT FK_DISEASE_ID
FOREIGN KEY(PATIENT_ID)
REFERENCES PATIENTS(PATIENT_ID)


CREATE TABLE NAME(
MED_ID INT NOT NULL,
MED_NAME VARCHAR(30))


INSERT INTO NAME
VALUES (400,'PEPSID')
INSERT INTO NAME
VALUES (401,'VENTOLIN')
INSERT INTO NAME
VALUES (402,'PROTONIX')
INSERT INTO NAME
VALUES (403,'NEXIUM')
INSERT INTO NAME
VALUES (404,'TUMS')


SELECT *FROM NAME

ALTER TABLE NAME
ADD CONSTRAINT FK_NAME_ID
FOREIGN KEY(MED_ID)
REFERENCES MEDICATIONS(MED_ID)

CREATE TABLE ASSINGTO(
PATIENT_ID INT NOT NULL,
DOCTOR_ID INT NOT NULL,
ASSIGNDATE DATE NOT NULL)

ALTER TABLE ASSINGTO
ADD CONSTRAINT FK_PATASSIGN_ID
FOREIGN KEY(PATIENT_ID)
REFERENCES PATIENTS(PATIENT_ID)

INSERT INTO ASSINGTO
VALUES(100,200,'2008-11-11')
INSERT INTO ASSINGTO
VALUES(101,201,'2020-12-20')
INSERT INTO ASSINGTO
VALUES(102,202,'2020-04-30')
INSERT INTO ASSINGTO
VALUES(103,203,'2020-09-05')
INSERT INTO ASSINGTO
VALUES(104,204,'2020-10-01')


SELECT *FROM ASSINGTO


ALTER TABLE ASSINGTO
ADD CONSTRAINT FK_ASSIGNDOC_ID
FOREIGN KEY(DOCTOR_ID)
REFERENCES DOCTORS(DOCTOR_ID)


CREATE TABLE BILL(
BILLNUMBER INT PRIMARY KEY,
TOTALPAYMENT INT NOT NULL,
PATIENT_ID INT NOT NULL)


INSERT INTO BILL
VALUES (50,1000,100)
INSERT INTO BILL
VALUES (51,2000,101)
INSERT INTO BILL
VALUES (52,1300,102)
INSERT INTO BILL
VALUES (53,800,103)
INSERT INTO BILL
VALUES (54,960,104)

SELECT *FROM BILL


ALTER TABLE BILL
ADD CONSTRAINT FK_BILL_ID
FOREIGN KEY(PATIENT_ID)
REFERENCES PATIENTS(PATIENT_ID)



--1.HOW MANY PROCEDURE PATIENT CAN TAKE?
SELECT COUNT(PROC_ID) FROM PROCEDURES
--2.SELECT PERSON NAME WHERE ROOMNUMBER IS EQUAL TO 4
SELECT NAME FROM PERSONS
WHERE ID=(SELECT ID FROM PATIENTS WHERE ROOMNUMBER=4)
--3.SELECT THE DOCTOR NAME WHO IS ASSIGN TO PATIENT_ID=104
SELECT NAME FROM PERSONS
WHERE ID=(SELECT ID FROM DOCTORS
WHERE DOCTOR_ID=(SELECT DOCTOR_ID FROM ASSINGTO
WHERE PATIENT_ID=104))

SELECT * FROM ASSINGTO
--4.FIND MED_FORM WHICH TAKEN PATIENT WHERE HIS ID =102
SELECT MED_FORM FROM MEDICATIONS
WHERE MED_ID=(SELECT MED_ID FROM TAKES WHERE PATIENT_ID=102)

--5.SELECT TOTALPAYMENT WHICH PAY BY PATIENT_ID=100
SELECT TOTALPAYMENT FROM BILL
WHERE PATIENT_ID=100


--6.WRITE THE INNER JOIN OF TWO TABLES(PATIENTS AND BILL)
SELECT * FROM PATIENTS
INNER JOIN BILL
ON PATIENTS.PATIENT_ID=BILL.PATIENT_ID

--7.FIND AVG TOTALPAYMENT FROM BILL TABEL
SELECT AVG(TOTALPAYMENT) FROM BILL


--8.FIND THE MAX REMAININGTIME  IN ROOMS
SELECT MAX(REMAININGTIME) FROM ROOMS

SELECT REMAININGTIME FROM ROOMS

